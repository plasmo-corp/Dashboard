import{ag as u,ah as I,r as _,K as j,i as g,d as r,e as h,g as a,E as D,F as P,v as $,z as q,A as E,p as T,f as z,h as H,k as K,o as R,ad as b,s as W,m as Z,q as G,y as A,ai as Q,af as B}from"./vendor.f6148a0a.js";import{_ as F}from"./index.3c0b9368.js";import{l as U,g as X}from"./color.556e4bcb.js";u.extend(I);const x={name:"DatePicker",props:{date:String,todo:{type:Object,required:!0},isDark:{type:Boolean,default:!1}},emit:["selectDate"],setup(e,{emit:o}){const d=_("");j(()=>e.date,p=>{d.value=u(p).format("YYYY-MM")},{immediate:!0});const c=["S","M","T","W","T","F","S"],n=g(()=>{const p=u().month(u(d.value).month()).startOf("month");let f=u().week(u(p).week()).startOf("week");const w=[];for(let M=0;M<35;M++){const L=~~f.format("DD"),O=f.format("YYYY-MM-DD"),N=~~f.format("MM");w.push({label:L,value:O,month:N}),f=f.add(1,"d")}return w}),C=g(()=>~~u(d.value).format("MM")),i=g(()=>u(d.value).format("MMM, YYYY")),m=g(()=>Object.keys(e.todo).filter(p=>e.todo[p].some(f=>!f.isChecked)));return{weekStrArr:c,dayList:n,selectedMonth:C,labelMonth:i,hasTodoListDates:m,handleClickDay:p=>o("selectDate",p),handlePrevClick:()=>{d.value=u(d.value).subtract(1,"month").format("YYYY-MM")},handleNextClick:()=>{d.value=u(d.value).add(1,"month").format("YYYY-MM")}}}},V=e=>(T("data-v-68c5d07e"),e=e(),z(),e),ee={class:"calendar__date"},te=V(()=>a("svg",{viewBox:"0 0 1024 1024",width:"20",height:"20"},[a("path",{d:"M754.739998 129.124869 677.034219 62.024635 266.002818 515.097548 672.169421 958.024379 749.894643 890.904703 408.017252 515.097548Z"})],-1)),oe=[te],ne={class:"calendar__head content"},ae=V(()=>a("svg",{viewBox:"0 0 1024 1024",width:"20",height:"20"},[a("path",{d:"M754.739998 129.124869 677.034219 62.024635 266.002818 515.097548 672.169421 958.024379 749.894643 890.904703 408.017252 515.097548Z"})],-1)),ie=[ae],se=["onClick"];function le(e,o,d,c,n,C){return r(),h("div",{class:"date-picker",style:E({"--themeTextColor1":d.isDark?"#fff":"#464646","--themeTextColor2":d.isDark?"#464646":"#fff"})},[a("div",ee,[a("div",{class:"calendar__head prev",onClick:o[0]||(o[0]=(...i)=>c.handlePrevClick&&c.handlePrevClick(...i))},oe),a("div",ne,D(c.labelMonth),1),a("div",{class:"calendar__head next",onClick:o[1]||(o[1]=(...i)=>c.handleNextClick&&c.handleNextClick(...i))},ie),(r(!0),h(P,null,$(c.weekStrArr,(i,m)=>(r(),h("div",{class:"calendar__day",key:i+m},D(i),1))),128)),(r(!0),h(P,null,$(c.dayList,i=>(r(),h("div",{class:q(["calendar__number",{"not-this-month":i.month!==c.selectedMonth,active:i.value===d.date,tips:c.hasTodoListDates.includes(i.value)}]),key:i.value,onClick:m=>c.handleClickDay(i)},D(i.label),11,se))),128))])],4)}var de=F(x,[["render",le],["__scopeId","data-v-68c5d07e"]]);const ce=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],re=H({name:"TodoList",components:{DatePicker:de},directives:{focus(e){document.activeElement!==e&&e.focus()}},props:{componentSetting:{type:Object,required:!0},element:{type:Object,required:!0},isAction:{type:Boolean,default:!1}},setup(e){const o=K(),d=g(()=>U(e.componentSetting.themeColor||"#643a7a",50)),c=g(()=>X(e.componentSetting.themeColor||"#643a7a")<150),n=_(),C=_(),i=_(270);R(()=>{var t,l;n.value=u().format("YYYY-MM-DD"),((l=(t=C.value)==null?void 0:t.$el)==null?void 0:l.offsetHeight)&&(i.value=C.value.$el.offsetHeight+30)});const m=_(""),s=_(!1),v=g(()=>e.componentSetting.todo[n.value]||[]),k=g(()=>ce[new Date(n.value).getDay()]),p=g(()=>{const t=new Date(n.value).toDateString().split(" ");return`${t[1]} ${t[2]}, ${t[3]}`});return{weekDay:k,formatterDate:p,todoList:v,handleChecked:t=>{const l=!v.value[t].isChecked,S=JSON.parse(JSON.stringify(e.element));e.isAction?(S.actionSetting.actionClickValue.componentSetting.todo[n.value][t].isChecked=l,o.dispatch("updateActionElement",S)):S.componentSetting.todo[n.value][t].isChecked=l,o.dispatch("editComponent",S)},handleRemove:t=>{const l=JSON.parse(JSON.stringify(e.element));e.isAction?(l.actionSetting.actionClickValue.componentSetting.todo[n.value].splice(t,1),o.dispatch("updateActionElement",l)):l.componentSetting.todo[n.value].splice(t,1),o.dispatch("editComponent",l)},handleAdd:()=>{m.value="";const t=JSON.parse(JSON.stringify(e.element)),l={content:"",isChecked:!1,isEditing:!0};e.isAction?(t.actionSetting.actionClickValue.componentSetting.todo[n.value]?t.actionSetting.actionClickValue.componentSetting.todo[n.value].push(l):t.actionSetting.actionClickValue.componentSetting.todo[n.value]=[l],o.dispatch("updateActionElement",t)):t.componentSetting.todo[n.value]?t.componentSetting.todo[n.value].push(l):t.componentSetting.todo[n.value]=[l],o.dispatch("editComponent",t)},handleEditSubmit:(t,l,S)=>{if(l.isEditing){const y=JSON.parse(JSON.stringify(e.element)),Y=e.isAction?y.actionSetting.actionClickValue.componentSetting.todo[n.value]:y.componentSetting.todo[n.value];t.currentTarget.value?(Y[S].content=m.value=t.currentTarget.value,Y[S].isEditing=!1):Y.splice(S,1),e.isAction&&o.dispatch("updateActionElement",y),o.dispatch("editComponent",y)}},editingValue:m,showDatePicker:s,date:n,updateDate:t=>{n.value=t.value},themeLightColor:d,isDark:c,dateTimePickerDom:C,pickerHeight:i,contextmenu:t=>{o.state.isLock&&t.stopPropagation()}}}}),J=e=>(T("data-v-2d2c82a4"),e=e(),z(),e),he={class:"head"},ue={class:"list"},me=["checked"],ve=["onClick"],ke=["value","onBlur","onKeyup"],pe=["onClick"],ge={class:"wrapper"},fe=["width","height"],Se=J(()=>a("path",{class:"checkmark",fill:"none","stroke-width":"8","stroke-miterlimit":"10",d:"M81.7,17.8C73.5,9.3,62,4,49.2,4C24.3,4,4,24.3,4,49.2s20.3,45.2,45.2,45.2s45.2-20.3,45.2-45.2c0-8.6-2.4-16.6-6.5-23.4l0,0L45.6,68.2L24.7,47.3"},null,-1)),Ce=[Se],_e=["onClick"],De=["width","height"],ye=J(()=>a("path",{d:"M510.8096 420.3008l335.296-335.296 90.5088 90.5088-335.296 335.296 335.296 335.296-90.5088 90.5088-335.296-335.296-335.296 335.296-90.5088-90.5088 335.296-335.296-335.296-335.296 90.5088-90.5088z"},null,-1)),we=[ye],Me={viewBox:"0 0 1024 1024",width:"20",height:"20"},Ye=["fill"];function be(e,o,d,c,n,C){const i=Z("DatePicker"),m=G("focus");return r(),h("div",{class:"todo-list-card",style:E({"--themeColor":e.componentSetting.themeColor,"--themeLightColor":e.themeLightColor,fontSize:e.componentSetting.baseFontSize+"px",padding:e.componentSetting.padding+"px"}),onContextmenu:o[3]||(o[3]=(...s)=>e.contextmenu&&e.contextmenu(...s))},[a("div",he,[a("div",{class:"title",onClick:o[0]||(o[0]=b(s=>e.showDatePicker=!e.showDatePicker,["stop"]))},D(e.weekDay),1),a("div",{class:"subtitle",onClick:o[1]||(o[1]=b(s=>e.showDatePicker=!e.showDatePicker,["stop"]))},D(e.formatterDate),1),a("div",{class:"picker",style:E(e.showDatePicker?`border-bottom: 1px solid var(--themeLightColor); height: ${e.pickerHeight}px`:"")},[W(i,{ref:"dateTimePickerDom",date:e.date,todo:e.componentSetting.todo,onSelectDate:e.updateDate,isDark:e.isDark},null,8,["date","todo","onSelectDate","isDark"])],4)]),a("ul",ue,[(r(!0),h(P,null,$(e.todoList,(s,v)=>(r(),h("li",{class:"list-item",key:s.content+v},[a("input",{type:"checkbox",name:"todo",checked:s.isChecked},null,8,me),s.isEditing?A((r(),h("input",{key:1,type:"text",class:"edit",value:e.editingValue,onBlur:k=>e.handleEditSubmit(k,s,v),onKeyup:Q(k=>e.handleEditSubmit(k,s,v),["enter"])},null,40,ke)),[[m]]):(r(),h("div",{key:0,class:"text",onClick:k=>e.handleChecked(v)},D(s.content),9,ve)),A(a("div",{class:"button",onClick:k=>e.handleChecked(v)},null,8,pe),[[B,!s.isChecked]]),A(a("div",ge,[(r(),h("svg",{viewBox:"0 0 98.5 98.5",width:20*e.componentSetting.baseFontSize/16,height:20*e.componentSetting.baseFontSize/16},Ce,8,fe))],512),[[B,s.isChecked]]),a("div",{class:"close",onClick:b(k=>e.handleRemove(v),["stop"])},[(r(),h("svg",{viewBox:"0 0 1024 1024",width:20*e.componentSetting.baseFontSize/16,height:20*e.componentSetting.baseFontSize/16},we,8,De))],8,_e)]))),128))]),a("div",{class:"add",onClick:o[2]||(o[2]=(...s)=>e.handleAdd&&e.handleAdd(...s))},[(r(),h("svg",Me,[a("path",{fill:e.isDark?"#fff":"#464646",d:"M510.8096 420.3008l335.296-335.296 90.5088 90.5088-335.296 335.296 335.296 335.296-90.5088 90.5088-335.296-335.296-335.296 335.296-90.5088-90.5088 335.296-335.296-335.296-335.296 90.5088-90.5088z"},null,8,Ye)]))])],36)}var Ee=F(re,[["render",be],["__scopeId","data-v-2d2c82a4"]]);export{Ee as default};
